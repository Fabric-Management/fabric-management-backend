# üîç ENVIRONMENT VARIABLE COMPLIANCE CHECK

**Date:** 2025-10-25  
**Status:** ‚úÖ COMPLIANT

---

## üìä ENVIRONMENT VARIABLES IN YML FILES

### **docker-compose.yml:**

```
POSTGRES_HOST, POSTGRES_PORT, POSTGRES_DB, POSTGRES_USER, POSTGRES_PASSWORD
REDIS_PASSWORD, REDIS_PORT, REDIS_MAX_MEMORY
ZOOKEEPER_PORT, ZOOKEEPER_CLIENT_PORT, ZOOKEEPER_TICK_TIME
KAFKA_PORT, KAFKA_BROKER_ID, KAFKA_REPLICATION_FACTOR, KAFKA_AUTO_CREATE_TOPICS
PROMETHEUS_PORT
GRAFANA_PORT, GRAFANA_ADMIN_USER, GRAFANA_ADMIN_PASSWORD, GRAFANA_ALLOW_SIGNUP
ALERTMANAGER_PORT
```

### **application.yml:**

```
SPRING_PROFILES_ACTIVE
SERVER_PORT
CACHE_MAX_SIZE, CACHE_EXPIRE_SECONDS
MULTIPART_MAX_FILE_SIZE, MULTIPART_MAX_REQUEST_SIZE
SERVER_COMPRESSION_ENABLED, SERVER_COMPRESSION_MIME_TYPES, SERVER_COMPRESSION_MIN_SIZE
HIBERNATE_FORMAT_SQL, HIBERNATE_USE_COMMENTS, HIBERNATE_BATCH_SIZE
HIBERNATE_ORDER_INSERTS, HIBERNATE_ORDER_UPDATES
APP_DESCRIPTION, APP_VERSION, APP_ARCHITECTURE
LOG_LEVEL (via logging.level.root)
JWT_SECRET, JWT_EXPIRATION, JWT_REFRESH_EXPIRATION
```

### **application-local.yml:**

```
DATABASE_URL, POSTGRES_HOST, POSTGRES_PORT, POSTGRES_DB
POSTGRES_USER, POSTGRES_PASSWORD
DB_POOL_MAX_SIZE, DB_POOL_MIN_IDLE, DB_CONNECTION_TIMEOUT, DB_IDLE_TIMEOUT, DB_MAX_LIFETIME
REDIS_HOST, REDIS_PORT, REDIS_PASSWORD
KAFKA_BOOTSTRAP_SERVERS
SERVER_PORT
```

### **application-prod.yml:**

```
DATABASE_URL, DB_USERNAME, DB_PASSWORD
DB_POOL_MAX_SIZE, DB_POOL_MIN_IDLE, DB_*_TIMEOUT, DB_LEAK_DETECTION_THRESHOLD
REDIS_HOST, REDIS_PORT, REDIS_PASSWORD, REDIS_TIMEOUT, REDIS_SSL
REDIS_POOL_MAX_ACTIVE, REDIS_POOL_MAX_IDLE, REDIS_POOL_MIN_IDLE
KAFKA_BOOTSTRAP_SERVERS, KAFKA_CONSUMER_GROUP_ID, KAFKA_AUTO_OFFSET_RESET
KAFKA_PRODUCER_ACKS, KAFKA_PRODUCER_RETRIES
LOG_FILE_PATH, LOG_FILE_MAX_SIZE, LOG_FILE_MAX_HISTORY
SERVER_PORT, SERVER_COMPRESSION_ENABLED, SERVER_HTTP2_ENABLED
JWT_SECRET, JWT_EXPIRATION, JWT_REFRESH_EXPIRATION
```

---

## ‚úÖ .env NEEDS (Required in .env):

### **CRITICAL (Must have):**

```bash
# Database
POSTGRES_HOST=localhost
POSTGRES_PORT=5433
POSTGRES_DB=fabric_management
POSTGRES_USER=fabric_user
POSTGRES_PASSWORD=local_dev_2024
DATABASE_URL=jdbc:postgresql://localhost:5433/fabric_management

# Redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=local_redis_pass
REDIS_MAX_MEMORY=256mb

# Application
SERVER_PORT=8080

# JWT
JWT_SECRET=<your-secret>
JWT_EXPIRATION=3600000
JWT_REFRESH_EXPIRATION=86400000

# Monitoring
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin
```

### **OPTIONAL (Has defaults in yml):**

```bash
# Kafka (all have defaults)
KAFKA_PORT=9092
KAFKA_BROKER_ID=1
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_REPLICATION_FACTOR=1
KAFKA_AUTO_CREATE_TOPICS=true
KAFKA_CONSUMER_GROUP_ID=fabric-management-group
# ... etc

# Cache (has defaults)
CACHE_MAX_SIZE=10000
CACHE_EXPIRE_SECONDS=300

# DB Pool (has defaults)
DB_POOL_MAX_SIZE=10
DB_POOL_MIN_IDLE=2
# ... etc
```

---

## ‚ö†Ô∏è CLEANUP NEEDED IN .env

### **REMOVE (Old microservices):**

```bash
‚ùå USER_SERVICE_PORT=8081
‚ùå CONTACT_SERVICE_PORT=8082
‚ùå COMPANY_SERVICE_PORT=8083
‚ùå USER_SERVICE_HOST
‚ùå CONTACT_SERVICE_HOST
‚ùå COMPANY_SERVICE_HOST
‚ùå API_GATEWAY_PORT (use SERVER_PORT instead)
‚ùå USER_SERVICE_JMX_PORT
‚ùå CONTACT_SERVICE_JMX_PORT
‚ùå COMPANY_SERVICE_JMX_PORT
‚ùå AUTH_SERVICE_PORT
‚ùå AUTH_SERVICE_HOST
‚ùå AUTH_SERVICE_URL
‚ùå AUTH_SERVICE_KAFKA_GROUP_ID
‚ùå AUTH_JAVA_OPTS
‚ùå INTERNAL_API_KEY
‚ùå CACHE_TTL (use CACHE_EXPIRE_SECONDS)
‚ùå REDIS_CONNECTION_TIMEOUT (not used)
‚ùå REDIS_COMMAND_TIMEOUT (not used)
‚ùå JWT_ALGORITHM (not configurable in code)
‚ùå JWT_ISSUER (not used)
‚ùå JWT_AUDIENCE (not used)
‚ùå NOTIFICATION_ENABLED (not used yet)
‚ùå CORS_ALLOWED_ORIGINS (not configured yet)
```

### **ADD (Missing variables):**

```bash
‚úÖ REDIS_MAX_MEMORY=256mb
‚úÖ ZOOKEEPER_CLIENT_PORT=2181
‚úÖ ZOOKEEPER_TICK_TIME=2000
‚úÖ KAFKA_BROKER_ID=1
‚úÖ KAFKA_REPLICATION_FACTOR=1
‚úÖ KAFKA_AUTO_CREATE_TOPICS=true
‚úÖ KAFKA_CONSUMER_GROUP_ID=fabric-management-group
‚úÖ KAFKA_AUTO_OFFSET_RESET=earliest
‚úÖ KAFKA_PRODUCER_ACKS=all
‚úÖ KAFKA_PRODUCER_RETRIES=3
‚úÖ PROMETHEUS_PORT=9090
‚úÖ ALERTMANAGER_PORT=9093
‚úÖ CACHE_MAX_SIZE=10000
‚úÖ CACHE_EXPIRE_SECONDS=300
‚úÖ MULTIPART_MAX_FILE_SIZE=10MB
‚úÖ MULTIPART_MAX_REQUEST_SIZE=10MB
‚úÖ SERVER_PORT=8080
```

---

## ‚úÖ COMPLIANCE STATUS:

| File                      | Status          | Missing Vars | Extra Vars  |
| ------------------------- | --------------- | ------------ | ----------- |
| **docker-compose.yml**    | ‚úÖ COMPLIANT    | 0            | 0           |
| **application.yml**       | ‚úÖ COMPLIANT    | 0            | 0           |
| **application-local.yml** | ‚úÖ COMPLIANT    | 0            | 0           |
| **application-prod.yml**  | ‚úÖ COMPLIANT    | 0            | 0           |
| **.env (current)**        | ‚ö†Ô∏è NEEDS UPDATE | 17 missing   | 25 obsolete |

---

## üéØ RECOMMENDED .env (CLEAN VERSION):

See: `.env.modular-monolith` file (I created this template)

Or manually update your .env with variables listed above.

---

**After updating .env, all yml files will be 100% compliant!** ‚úÖ
